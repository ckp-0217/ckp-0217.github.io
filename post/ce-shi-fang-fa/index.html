<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
<meta name="description" content="区块链、web3、金融、智能合约" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>测试方法 | Wild</title>
<link rel="shortcut icon" href="https://ckp-0217.github.io/favicon.ico?v=1685365345190">
<link rel="stylesheet" href="https://ckp-0217.github.io/styles/main.css">


    <link rel="canonical" href="https://ckp-0217.github.io/post/ce-shi-fang-fa/" />
    <meta name="socialText" content="" />
    <meta name="description" content="合约载入
    const management = await (await hre.ethers.getContractFactory(&amp;quot;Management&amp;quot;,
        {
            lib..." />
    <meta name="referrer" content="always" />
    
      <link rel="stylesheet" href="https://ckp-0217.github.io/media/css/katex.min.css">
      <script defer src="https://ckp-0217.github.io/media/scripts/katex.min.js"></script>
      <script defer src="https://ckp-0217.github.io/media/scripts/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>
      
        
          <link rel="stylesheet" href="https://ckp-0217.github.io/media/css/prism.css">
          
            
                
</head>

<body class="is-preload">
  <!-- Wrapper -->
  <div id="wrapper">

    <!-- Header -->
<header id="header">
  <div class="inner">
    <!-- Logo -->
    <a href="https://ckp-0217.github.io" class="logo">
      
          <span class="symbol"><img src="https://ckpdebucket.oss-cn-hangzhou.aliyuncs.com/5899.png" alt="" />
            
                <img src="https://ckpdebucket.oss-cn-hangzhou.aliyuncs.com/wild.png" alt="" />
                
                
          </span>
          


            <div class="site-title">
              
              
                <div style="font-size: 0.4em;">
                  区块链、web3、金融、智能合约
                </div>

            </div>

    </a>
    <div id="search" style="margin-top: 10px" >
      <div>
        <form id="gridea-search-form" data-update="1685365345190" action="/search/index.html"><input
            class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..." />
        </form>
      </div>
    </div>


    <!-- Nav -->
    <nav>
      <ul>
        <li><a href="#menu">Menu</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Menu -->
<nav id="menu">
  <ul>
    
      
          <li><a href="https://ckp-0217.github.io" class="menu">
              主页
            </a></li>
          
            
      
          <li><a href="https://ckp-0217.github.io/archives" class="menu">
              归档
            </a></li>
          
            
      
          <li><a href="https://ckp-0217.github.io/tags" class="menu">
              标签
            </a></li>
          
            
      
          <li><a href="https://ckp-0217.github.io/signature" class="menu">
              签名
            </a></li>
          
            
      
          <li><a href="https://ckp-0217.github.io/forecast" class="menu">
              预测
            </a></li>
          
            
  </ul>
</nav>
      <!-- Main -->
      <div id="main">
        <div class="tags-container-sticky">
  
    
      
        
                  
        
                  
        
                  
        
                  
        
          
            
                  
        
          
                
          
            
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
            
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/zhi-ya-jie-dai/">
                      质押借贷 <span style="color:#ed556a;font-weight: 1000;">
                          3
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
            
                  
        
          
                
          
                
          
            
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
            
                  
        
          
            
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
            
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/YpOF8hrMn/">
                      DeFi <span style="color:#ed556a;font-weight: 1000;">
                          5
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
            
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/yuan-ma-fen-xi/">
                      源码分析 <span style="color:#ed556a;font-weight: 1000;">
                          1
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
            
                  
        
          
            
                  
        
          
            
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/jiao-yi-jie-xi/">
                      交易解析 <span style="color:#ed556a;font-weight: 1000;">
                          3
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
            
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/nft/">
                      NFT <span style="color:#ed556a;font-weight: 1000;">
                          1
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
            
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
            
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/idIT1Ofe5/">
                      开发工具 <span style="color:#ed556a;font-weight: 1000;">
                          2
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
            
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/jin-rong-li-lun/">
                      金融理论 <span style="color:#ed556a;font-weight: 1000;">
                          1
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
            
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
            
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/an-quan/">
                      安全 <span style="color:#ed556a;font-weight: 1000;">
                          2
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
            
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
            
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/shen-ji/">
                      审计 <span style="color:#ed556a;font-weight: 1000;">
                          2
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
            
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
            
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/dai-li-sheng-ji/">
                      代理升级 <span style="color:#ed556a;font-weight: 1000;">
                          2
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
            
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
            
                  
        
          
                
                  
        
          
                
          
                
          
            
                  
        
          
                
          
            
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
                  
        
          
            
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/CHkr7jZdg/">
                      智能合约 <span style="color:#ed556a;font-weight: 1000;">
                          5
                        </span>
                    </a>
                    
    
      
        
                  
        
                  
        
                  
        
                  
        
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
                  
        
          
                
          
                
                  
        
          
                
                  
        
                  
        
                  
        
                  
        
          
                
                  
        
          
                
                  
        
          
                
          
                
          
                
                  
        
          
                
          
                
          
                
                  
        
          
            
                  
        
          
            
                  
        
                  
        
                  
        
                  
        
                  
        
          
                
                  
                    <a class="tag" href="https://ckp-0217.github.io/tag/he-yue-ce-shi/">
                      合约测试 <span style="color:#ed556a;font-weight: 1000;">
                          2
                        </span>
                    </a>
                    
</div>
          <div class="inner">
            <div class="post-pagetitle">
              <h1>
                测试方法
              </h1>
            </div>
            <div class="post-info">
              <time class="post-time">
                2023-01-04
              </time>
              <span class="read-times">
                2 min read
              </span>
              
            </div>
            
                <div class="post-content-wrapper">
                  <div class="post-content">
                    <h2 id="合约载入">合约载入</h2>
<pre><code class="language-js">    const management = await (await hre.ethers.getContractFactory(&quot;Management&quot;,
        {
            libraries: { LManagement: token_address.LMANAGEMENTL_ADDRESS }
        })).connect(owner).attach(token_address.MANAGEMENT_ADDRESS);
</code></pre>
<h2 id="gas费测试">gas费测试</h2>
<pre><code class="language-js">let maxPriority = new hre.ethers.utils.parseUnits(&quot;1.5&quot;, 9);
let baseFee = (await hre.ethers.provider.getBlock()).baseFeePerGas;

let gasFee = {
    maxFeePerGas: (baseFee.mul(2)).add(maxPriority),//*2 + maxPriority
    maxPriorityFeePerGas: maxPriority
};
</code></pre>
<h2 id="单位换算">单位换算</h2>
<pre><code class="language-js">utils.parseEther('10000')
</code></pre>
<h2 id="类型转换">类型转换</h2>
<pre><code class="language-js">Number(utils.formatEther(await ut.balanceOf(addr1.address))
</code></pre>
<h2 id="整体架构">整体架构</h2>
<pre><code class="language-js">describe(&quot;AMM-test-AMM-2&quot;, function () {

    before(async function () {
    }//看情况可以使用beforeEach
    
    it('1 Add initial liquidity by the issuer', async () =&gt; {
    await amm.connect(Issuer).initAddLiquidity(deadline);
  })
  
    it('2 Add initial liquidity by the issuer', async () =&gt; {
    await amm.connect(Issuer).initAddLiquidity(deadline);
  })
}

</code></pre>
<h2 id="断言比较-相等">断言比较 相等</h2>
<pre><code class="language-js">    expect(await SDG.connect(owner).balanceOf(address)).to.be.equal(utils.parseEther('362042.138457000847911013'));

</code></pre>
<h2 id="断言比较-近似">断言比较 近似</h2>
<pre><code class="language-js">    expect(Number(utils.formatEther(await ut.balanceOf(addr1.address)))).to.be.closeTo(1900, delta);

</code></pre>
<h2 id="断言报错">断言报错</h2>
<pre><code class="language-js">await expect(amm.connect(addr1).addLiquidity(e('2000'), e('1900'), deadline))
      .to.be.revertedWith(&quot;错误信息&quot;);
</code></pre>

                  </div>
                  <div class="toc-container">
                    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%90%88%E7%BA%A6%E8%BD%BD%E5%85%A5">合约载入</a></li>
<li><a href="#gas%E8%B4%B9%E6%B5%8B%E8%AF%95">gas费测试</a></li>
<li><a href="#%E5%8D%95%E4%BD%8D%E6%8D%A2%E7%AE%97">单位换算</a></li>
<li><a href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">类型转换</a></li>
<li><a href="#%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84">整体架构</a></li>
<li><a href="#%E6%96%AD%E8%A8%80%E6%AF%94%E8%BE%83-%E7%9B%B8%E7%AD%89">断言比较 相等</a></li>
<li><a href="#%E6%96%AD%E8%A8%80%E6%AF%94%E8%BE%83-%E8%BF%91%E4%BC%BC">断言比较 近似</a></li>
<li><a href="#%E6%96%AD%E8%A8%80%E6%8A%A5%E9%94%99">断言报错</a></li>
</ul>
</li>
</ul>

                  </div>
                </div>

                <div class="page-count">
                  

                      
                </div>
                <div class="post-pagination inner">
                  
                    <div class="prev-post">
                      <div>
                        <a href="https://ckp-0217.github.io/post/call-data-jie-xi/">上一篇 Call Data 解析</a>

                      </div>
                    </div>
                    
                  
                    <div class="next-post">
                      <div>
                        <a href="https://ckp-0217.github.io/post/hardhat-chang-yong-kuo-zhan-cha-jian/">下一篇 Hardhat常用扩展插件</a>

                      </div>
                    </div>
                    
                     
                </div>

          </div>


      </div>

      <!-- back to top -->
      <button oneclik="topFunction()" id="BackToTop">
        TOP
      </button>

      <div class="post-comment inner">
        <div class="post-comment">
          





        </div>
      </div>

      <!-- Footer -->
      <!-- Footer -->
<footer id="footer">
  <div class="inner">
    <section>
      <h2>Follow</h2>
      <ul class="icons">
        
          
          <li>
            <a href="https://github.com/ckp-0217" target="_blank">
              <i class="icon brands style2 fab fa-github"></i>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </section>
    <ul class="copyright">
      <li>
        <a href="https://ckp-0217.github.io/atom.xml" target="_blank">
          RSS
        </a> 
      </li>
      <li>ckp0217@foxmail.com</li>
      
    </ul>
  </div>
</footer>
  </div>

  <!-- Scripts -->
  <script src="https://ckp-0217.github.io/media/scripts/jquery.min.js"></script>
  <script src="https://ckp-0217.github.io/media/scripts/browser.min.js"></script>
  <script src="https://ckp-0217.github.io/media/scripts/breakpoints.min.js"></script>
  <script src="https://ckp-0217.github.io/media/scripts/util.js"></script>
  <script src="https://ckp-0217.github.io/media/scripts/main.js"></script>
  
    <script src="https://ckp-0217.github.io/media/scripts/prism.js"></script>
    <script>
      Prism.highlightAll();
    </script>
    
      <script>
        post_scroll();
        back_to_top();
      </script>
</body>

</html>